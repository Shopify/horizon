{% comment %}
  Featured Goods â€“ curated grid for handcrafted or seasonal products.
{% endcomment %}

{% liquid
  assign section_id = 'FeaturedGoods-' | append: section.id
  assign columns = section.settings.columns | default: 3
  if columns < 1
    assign columns = 1
  endif
%}

<section
  id="{{ section_id }}"
  class="featured-goods section color-{{ section.settings.color_scheme }}"
  aria-label="{{ section.settings.heading | default: 'Featured goods' | escape }}"
>
  <div class="section-background color-{{ section.settings.color_scheme }}"></div>
  <div class="page-width featured-goods__inner">
    {% if section.settings.heading != blank or section.settings.subheading != blank %}
      <header class="featured-goods__header">
        {% if section.settings.heading != blank %}
          <h2 class="featured-goods__title">{{ section.settings.heading }}</h2>
        {% endif %}
        {% if section.settings.subheading != blank %}
          <p class="featured-goods__subheading">{{ section.settings.subheading }}</p>
        {% endif %}
      </header>
    {% endif %}

    {% if section.blocks.size > 0 %}
      <div class="featured-goods__grid" role="list">
        {% for block in section.blocks %}
          {% assign product = block.settings.product %}
          <article
            class="featured-goods__card{% if block.settings.highlight_card %} featured-goods__card--highlight{% endif %}"
            role="listitem"
            {{ block.shopify_attributes }}
          >
            {% if block.settings.tagline != blank %}
              <p class="featured-goods__tagline">{{ block.settings.tagline }}</p>
            {% endif %}

            <div class="featured-goods__media">
              {% if block.settings.image != blank %}
                {{
                  block.settings.image
                  | image_url: width: 900
                  | image_tag:
                    loading: 'lazy',
                    class: 'featured-goods__image',
                    widths: '360, 540, 720, 900',
                    sizes: '(min-width: 1200px) 360px, (min-width: 750px) 45vw, 80vw',
                    alt: block.settings.image.alt | default: block.settings.title
                }}
              {% elsif product %}
                {{
                  product.featured_media
                  | image_url: width: 900
                  | image_tag:
                    loading: 'lazy',
                    class: 'featured-goods__image',
                    widths: '360, 540, 720, 900',
                    sizes: '(min-width: 1200px) 360px, (min-width: 750px) 45vw, 80vw',
                    alt: product.featured_media.alt | default: product.title
                }}
              {% else %}
                {{ 'image' | placeholder_svg_tag: 'placeholder featured-goods__image' }}
              {% endif %}
            </div>

            <div class="featured-goods__content">
              {% if block.settings.title != blank %}
                <h3 class="featured-goods__item-title">{{ block.settings.title }}</h3>
              {% elsif product %}
                <h3 class="featured-goods__item-title">{{ product.title }}</h3>
              {% endif %}

              {% if block.settings.description != blank %}
                <p class="featured-goods__description">{{ block.settings.description }}</p>
              {% elsif product %}
                <p class="featured-goods__description">{{ product.description | strip_html | truncate: 140 }}</p>
              {% endif %}

              {% if block.settings.price_note != blank %}
                <p class="featured-goods__price-note">{{ block.settings.price_note }}</p>
              {% elsif product %}
                <p class="featured-goods__price-note">
                  {{ product.price | money }}
                  {% if product.compare_at_price_max > product.price %}
                    <span class="featured-goods__price-note--compare">{{ product.compare_at_price_max | money }}</span>
                  {% endif %}
                </p>
              {% endif %}

              {% if block.settings.link_label != blank and block.settings.link != blank %}
                <a class="featured-goods__cta" href="{{ block.settings.link }}">
                  {{ block.settings.link_label }}
                </a>
              {% elsif product %}
                <a class="featured-goods__cta" href="{{ product.url }}">
                  {{ 'products.product.view_product' | t | default: 'View product' }}
                </a>
              {% endif %}
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <div class="featured-goods__empty">
        <p>{{ 'sections.featured_collection.no_products' | t }}</p>
      </div>
    {% endif %}
  </div>

  <style>
    #{{ section_id }} {
      --featured-goods-columns: {{ columns }};
      --featured-goods-gap: clamp(1.75rem, 3vw, 2.5rem);
      padding-block: clamp(3rem, 6vw, 5rem);
    }

    #{{ section_id }} .page-width {
      max-width: 1280px;
    }

    #{{ section_id }} .featured-goods__header {
      text-align: center;
      margin-bottom: clamp(1.5rem, 4vw, 2.5rem);
      max-width: 720px;
      margin-inline: auto;
    }

    #{{ section_id }} .featured-goods__title {
      margin: 0;
      font-size: clamp(2rem, 2vw + 1rem, 3rem);
    }

    #{{ section_id }} .featured-goods__subheading {
      margin: 0.75rem 0 0;
      color: rgb(var(--color-foreground-secondary-rgb, 80 80 80));
      line-height: 1.6;
    }

    #{{ section_id }} .featured-goods__grid {
      display: grid;
      gap: var(--featured-goods-gap);
      grid-template-columns: repeat(var(--featured-goods-columns), minmax(0, 1fr));
    }

    #{{ section_id }} .featured-goods__card {
      background: rgba(var(--color-base-background-1-rgb, 255 255 255), 0.88);
      border-radius: 28px;
      overflow: hidden;
      display: grid;
      gap: 1.5rem;
      padding: clamp(1.75rem, 3vw, 2.5rem);
      box-shadow: 0 20px 50px rgba(38, 24, 3, 0.12);
      transition: transform 250ms ease, box-shadow 250ms ease;
    }

    #{{ section_id }} .featured-goods__card:hover,
    #{{ section_id }} .featured-goods__card:focus-within {
      transform: translateY(-8px);
      box-shadow: 0 32px 65px rgba(38, 24, 3, 0.18);
    }

    #{{ section_id }} .featured-goods__card--highlight {
      background: color-mix(in srgb, rgba(255, 244, 226, 0.95) 70%, #fff 30%);
      border: 2px solid rgba(212, 177, 110, 0.35);
    }

    #{{ section_id }} .featured-goods__tagline {
      margin: 0;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      font-size: 0.75rem;
      color: rgba(126, 93, 41, 0.75);
    }

    #{{ section_id }} .featured-goods__media {
      position: relative;
      overflow: hidden;
      border-radius: 20px;
      aspect-ratio: 4 / 3;
      background: rgba(255, 248, 234, 0.8);
    }

    #{{ section_id }} .featured-goods__image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 300ms ease;
    }

    #{{ section_id }} .featured-goods__card:hover .featured-goods__image,
    #{{ section_id }} .featured-goods__card:focus-within .featured-goods__image {
      transform: scale(1.06);
    }

    #{{ section_id }} .featured-goods__content {
      display: grid;
      gap: 0.75rem;
    }

    #{{ section_id }} .featured-goods__item-title {
      margin: 0;
      font-size: clamp(1.4rem, 1.5vw + 0.8rem, 2rem);
    }

    #{{ section_id }} .featured-goods__description {
      margin: 0;
      line-height: 1.65;
      color: rgb(var(--color-foreground-secondary-rgb, 90 90 90));
    }

    #{{ section_id }} .featured-goods__price-note {
      margin: 0;
      font-weight: 600;
      color: rgba(118, 77, 29, 0.85);
    }

    #{{ section_id }} .featured-goods__price-note--compare {
      text-decoration: line-through;
      margin-left: 0.4rem;
      font-weight: 400;
      color: rgba(118, 77, 29, 0.55);
    }

    #{{ section_id }} .featured-goods__cta {
      justify-self: start;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      text-decoration: none;
      padding: 0.65rem 1.25rem;
      border-radius: 999px;
      background: rgba(118, 77, 29, 0.1);
      color: rgba(94, 58, 15, 0.92);
      transition: background-color 200ms ease, color 200ms ease;
    }

    #{{ section_id }} .featured-goods__cta:hover,
    #{{ section_id }} .featured-goods__cta:focus-visible {
      background: rgba(118, 77, 29, 0.18);
      color: rgba(94, 58, 15, 1);
    }

    #{{ section_id }} .featured-goods__empty {
      text-align: center;
      padding: 2rem;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.7);
    }

    @media (max-width: 989px) {
      #{{ section_id }} {
        --featured-goods-columns: min(2, {{ columns }});
      }
    }

    @media (max-width: 749px) {
      #{{ section_id }} {
        --featured-goods-columns: 1;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      #{{ section_id }} .featured-goods__card,
      #{{ section_id }} .featured-goods__image {
        transition-duration: 0ms !important;
        transform: none !important;
      }
    }
  </style>
</section>

{% schema %}
{
  "name": "Featured goods",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured goods"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Supporting text",
      "default": "Notes from the syrup room, limited releases and seasonal favourites."
    },
    {
      "type": "range",
      "id": "columns",
      "label": "Desktop columns",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    }
  ],
  "blocks": [
    {
      "type": "good",
      "name": "Good",
      "settings": [
        { "type": "product", "id": "product", "label": "Product (optional)" },
        { "type": "image_picker", "id": "image", "label": "Custom image" },
        { "type": "text", "id": "tagline", "label": "Tagline", "default": "Limited release" },
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "textarea", "id": "description", "label": "Description" },
        { "type": "text", "id": "price_note", "label": "Price note" },
        { "type": "checkbox", "id": "highlight_card", "label": "Highlight card", "default": false },
        { "type": "text", "id": "link_label", "label": "Call-to-action label", "default": "Shop now" },
        { "type": "url", "id": "link", "label": "Call-to-action link" }
      ]
    }
  ],
  "enabled_on": {
    "templates": [
      "index",
      "collection",
      "list-collections",
      "product",
      "page",
      "article",
      "blog"
    ]
  },
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "presets": [
    {
      "name": "Featured goods",
      "category": "Golden",
      "blocks": [
        { "type": "good" },
        { "type": "good" },
        { "type": "good" }
      ]
    }
  ]
}
{% endschema %}
